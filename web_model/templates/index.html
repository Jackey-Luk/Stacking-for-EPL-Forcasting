<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>æ¯”èµ›é¢„æµ‹ç³»ç»Ÿ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding-top: 40px;
            background-color: #f8f9fa;
        }
        .chart-img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1 class="text-center mb-4">ğŸŸï¸ æ¯”èµ›èƒœè´Ÿé¢„æµ‹</h1>

    <form method="post" action="/predict" class="row g-3">
        <div class="col-md-4">
            <label class="form-label">æ¯”èµ›æ—¥æœŸ</label>
            <input type="text" name="date" class="form-control" required value="{{ date or '' }}">
        </div>
        <div class="col-md-4">
            <label class="form-label">ä¸»é˜Ÿ</label>
            <input type="text" name="home_team" class="form-control" required value="{{ home_team or '' }}">
        </div>
        <div class="col-md-4">
            <label class="form-label">å®¢é˜Ÿ</label>
            <input type="text" name="away_team" class="form-control" required value="{{ away_team or '' }}">
        </div>
        <div class="col-md-4">
            <label class="form-label">é€‰æ‹©æ¨¡å‹</label>
            <select name="model_choice" class="form-select">
                <option value="lstm" {% if model_choice == 'lstm' %}selected{% endif %}>LSTM</option>
                <option value="xgboost" {% if model_choice == 'xgboost' %}selected{% endif %}>XGBoost</option>
                <option value="lightgbm" {% if model_choice == 'lightgbm' %}selected{% endif %}>LightGBM</option>
                <option value="catboost" {% if model_choice == 'catboost' %}selected{% endif %}>CatBoost</option>
            </select>
        </div>
        <div class="col-12 text-center mt-4">
            <button type="submit" class="btn btn-primary btn-lg">é¢„æµ‹</button>
        </div>
    </form>

    {% if error %}
        <div class="alert alert-danger mt-4" role="alert">{{ error }}</div>
    {% endif %}

{% if result %}
    <div class="mt-5">
        <h2 class="text-center mb-4">ğŸ¯ é¢„æµ‹ç»“æœ</h2>
        <p><strong>æ¯”èµ›ï¼š</strong>{{ result.home_team }} vs {{ result.away_team }}</p>
        <p><strong>é¢„æµ‹ç»“æœï¼š</strong>{{ result.predicted }}</p>
        <p><strong>å®é™…ç»“æœï¼š</strong>{{ result.actual }}</p>
        <p><strong>å†å²äº¤æˆ˜æ€»è¿›çƒæ•°ï¼š</strong> {{ result.home_team }} {{ home_total_goals }} - {{ away_total_goals }} {{ result.away_team }}</p>
    </div>

    <div class="row mt-5">
        {% if history_chart %}
        <div class="col-md-12 text-center mb-4">
            <h4 class="mb-3">ğŸ“Š å†å²äº¤æˆ˜è¿›çƒå›¾</h4>
            <img src="{{ history_chart }}" alt="å†å²äº¤æˆ˜å›¾" class="chart-img">
        </div>
        {% endif %}

        {% if home_team_history_list %}
        <div class="col-md-6 text-center mb-4">
            <h4 class="mb-3">ğŸ  {{ result.home_team }} æœ€è¿‘5åœºæ¯”èµ›</h4>
            <p><strong>è¿›çƒæ•°ï¼š</strong> {{ home_history_goals }} &nbsp; | &nbsp; <strong>å¤±çƒæ•°ï¼š</strong> {{ home_history_loss }}</p>
            <table class="table table-bordered table-sm text-center">
              <thead class="table-light">
                <tr>
                  <th>æ—¥æœŸ</th>
                  <th>ä¸»é˜Ÿ</th>
                  <th>æ¯”åˆ†</th>
                  <th>å®¢é˜Ÿ</th>
                </tr>
              </thead>
              <tbody>
                {% for match in home_team_history_list %}
                  {% set parts = match.split('_') %}
                  <tr>
                    <td>{{ parts[0] }}</td>
                    <td>{{ parts[1] }}</td>
                    <td>{{ parts[2] }}</td>
                    <td>{{ parts[3] }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>

        </div>
        {% endif %}

        {% if away_team_history_list %}
        <div class="col-md-6 text-center mb-4">
            <h4 class="mb-3">ğŸ›« {{ result.away_team }} æœ€è¿‘5åœºæ¯”èµ›</h4>
            <p><strong>è¿›çƒæ•°ï¼š</strong> {{ away_history_goals }} &nbsp; | &nbsp; <strong>å¤±çƒæ•°ï¼š</strong> {{ away_history_loss }}</p>
            <table class="table table-bordered table-sm text-center">
              <thead class="table-light">
                <tr>
                  <th>æ—¥æœŸ</th>
                  <th>ä¸»é˜Ÿ</th>
                  <th>æ¯”åˆ†</th>
                  <th>å®¢é˜Ÿ</th>
                </tr>
              </thead>
              <tbody>
                {% for match in away_team_history_list %}
                  {% set parts = match.split('_') %}
                  <tr>
                    <td>{{ parts[0] }}</td>
                    <td>{{ parts[1] }}</td>
                    <td>{{ parts[2] }}</td>
                    <td>{{ parts[3] }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
        </div>
        {% endif %}

    </div>
{% endif %}
</div>
</body>
</html>
